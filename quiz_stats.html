<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°ÙƒÙŠØ© | Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù…Ù†ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- MathJax Ù„Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ© -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true
        },
        svg: {
          fontCache: 'global'
        },
        options: {
          enableMenu: false,
          renderActions: {
            addMenu: [],
            checkLoading: []
          }
        },
        startup: {
          ready: () => {
            MathJax.startup.defaultReady();
          }
        }
      };
    </script>
    <script id="MathJax-script" async 
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    
    <style>
        /* --- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø­Ù…Ø± Ø§Ù„Ù…Ø±Ø¬Ø§Ù†ÙŠ/Ø§Ù„Ø¨Ø·ÙŠØ®ÙŠ --- */
        :root {
            --primary: #0f172a;          /* Ø£Ø²Ø±Ù‚ Ø¯Ø§ÙƒÙ† */
            --secondary: #1e293b;        /* Ø£Ø²Ø±Ù‚ Ù…ØªÙˆØ³Ø· */
            --accent: #FF6B6B;           /* Ø£Ø­Ù…Ø± Ù…Ø±Ø¬Ø§Ù†ÙŠ */
            --accent-dark: #FF4757;      /* Ø£Ø­Ù…Ø± Ù…Ø±Ø¬Ø§Ù†ÙŠ Ø¯Ø§ÙƒÙ† */
            --accent-light: #FFB8B8;     /* Ø£Ø­Ù…Ø± Ø¨Ø·ÙŠØ®ÙŠ ÙØ§ØªØ­ */
            --gold: #d4af37;
            --gold-dark: #b8860b;
            --bg: #f8fafc;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-main: #1e293b;
            --text-muted: #64748b;
            --white: #ffffff;
            --danger: #ef4444;
            --success: #22c55e;
            --warning: #f59e0b;
            --info: #3b82f6;
            --border-radius: 20px;
            --shadow-md: 0 10px 30px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 20px 50px rgba(0, 0, 0, 0.12);
            --shadow-accent: 0 8px 25px rgba(255, 107, 107, 0.25);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
        }
        
        /* --- Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color: var(--text-main);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* --- Ø§Ù„Ù†Ø§ÙØ¨Ø§Ø± Ø§Ù„Ù…ØªÙ…ÙŠØ² --- */
        .navbar {
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            padding: 0;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 9999;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-bottom: 2px solid rgba(255, 107, 107, 0.3);
            animation: slideDown 0.5s ease-out;
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
        }
        
        .logo {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .uni-name {
            font-weight: 900;
            font-size: 1.2rem;
            color: var(--white);
        }
        
        .app-tag {
            font-size: 0.9rem;
            color: var(--accent);
            font-weight: 700;
        }
        
        /* Ø²Ø± Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ */
        .btn-cancel {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(255, 71, 87, 0.1));
            color: var(--white);
            padding: 10px 24px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 800;
            font-size: 0.9rem;
            border: 2px solid rgba(255, 107, 107, 0.3);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.15);
        }
        
        .btn-cancel:hover {
            background: var(--accent);
            color: var(--white);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
            border-color: var(--accent);
        }
        
        /* --- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© --- */
        .container {
            max-width: 800px;
            margin: 100px auto 80px;
            padding: 0 20px;
        }
        
        /* --- Ø§Ù„Ù„ÙˆØ¯Ø± --- */
        #loader {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            color: var(--primary);
            text-align: center;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 107, 107, 0.1);
            border-top: 5px solid var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.2);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        #loader p {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent);
        }
        
        /* --- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… --- */
        .progress-bar {
            background: rgba(226, 232, 240, 0.8);
            height: 12px;
            border-radius: 20px;
            margin: 30px auto 50px;
            max-width: 800px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .progress {
            background: linear-gradient(90deg, var(--accent), var(--accent-dark));
            height: 100%;
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* --- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© --- */
        #question-container {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        
        #question-container.loaded {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* --- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø© --- */
        .q-card {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 35px 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-md);
            border: 1.5px solid rgba(255, 107, 107, 0.1);
            animation: cardSlideIn 0.5s ease-out forwards;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes cardSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .q-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.05), transparent);
            border-radius: 0 0 0 100%;
        }
        
        /* Ø¨Ø§Ø¯Ø¬ ØªØ±Ù‚ÙŠÙ… Ø§Ù„Ø³Ø¤Ø§Ù„ */
        .badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--accent);
            padding: 8px 20px;
            border-radius: 8px;
            font-weight: 900;
            font-size: 0.9rem;
            margin-bottom: 25px;
            border: 2px solid rgba(255, 107, 107, 0.2);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ */
        .q-text-eng {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1.7;
            text-align: left;
            direction: ltr;
            margin: 20px 0 35px 0;
            padding-left: 15px;
            border-left: 4px solid var(--accent);
        }
        
        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø© */
        .opt-btn {
            padding: 20px 25px;
            border-radius: 16px;
            border: 2px solid #f1f5f9;
            background: #f8fafc;
            text-align: left;
            direction: ltr;
            font-size: 1.05rem;
            font-weight: 700;
            color: var(--text-main);
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.03);
            position: relative;
            overflow: hidden;
        }
        
        .opt-btn:hover {
            border-color: var(--accent);
            background: #fff0f0;
            transform: translateX(10px);
            box-shadow: var(--shadow-accent);
        }
        
        .opt-btn.selected {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05));
            box-shadow: var(--shadow-accent);
        }
        
        /* ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© ÙˆØ§Ù„Ø®Ø§Ø·Ø¦Ø© ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© */
        .review-mode .opt-btn.correct-answer {
            border-color: var(--success) !important;
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(34, 197, 94, 0.1)) !important;
            position: relative;
        }
        
        .review-mode .opt-btn.correct-answer::after {
            content: 'âœ“';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--success);
            font-weight: 900;
            font-size: 1.2rem;
        }
        
        .review-mode .opt-btn.wrong-answer {
            border-color: var(--danger) !important;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1)) !important;
            position: relative;
        }
        
        .review-mode .opt-btn.wrong-answer::after {
            content: 'âœ—';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--danger);
            font-weight: 900;
            font-size: 1.2rem;
        }
        
        .review-mode .opt-btn.not-selected {
            opacity: 0.7;
            filter: grayscale(0.3);
        }
        
        /* Ø´Ø§Ø±Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¤Ø§Ù„ */
        .correct-badge {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--success);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 800;
            display: none;
            z-index: 2;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        }
        
        .review-mode .correct-badge {
            display: block;
        }
        
        /* --- Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª --- */
        .quiz-footer {
            text-align: center;
            margin-top: 50px;
            padding-bottom: 80px;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        #submit-btn, #review-btn, #exit-review-btn {
            display: none;
            padding: 18px 40px;
            border-radius: 15px;
            border: none;
            font-size: 1.2rem;
            font-weight: 900;
            cursor: pointer;
            transition: var(--transition);
            min-width: 250px;
            position: relative;
            overflow: hidden;
            z-index: 10;
            font-family: 'Cairo', sans-serif;
        }
        
        #submit-btn {
            background: linear-gradient(135deg, var(--gold), var(--gold-dark));
            color: var(--primary);
            box-shadow: 0 10px 25px rgba(212, 175, 55, 0.3);
        }
        
        #review-btn, #exit-review-btn {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: var(--white);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.3);
        }
        
        #submit-btn:hover, #review-btn:hover, #exit-review-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        
        #submit-btn:active, #review-btn:active, #exit-review-btn:active {
            transform: translateY(-2px);
        }
        
        #submit-btn::before, #review-btn::before, #exit-review-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            transition: left 0.5s ease;
        }
        
        #submit-btn:hover::before, #review-btn:hover::before, #exit-review-btn:hover::before {
            left: 100%;
        }
        
        /* --- Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…ØªÙ…ÙŠØ² --- */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            z-index: 99999;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 50px 40px;
            border-radius: 28px;
            width: 100%;
            max-width: 500px;
            text-align: center;
            box-shadow: var(--shadow-lg);
            border: 2px solid rgba(255, 107, 107, 0.3);
            animation: modalSlideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        @keyframes modalSlideUp {
            from {
                transform: translateY(30px) scale(0.95);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }
        
        .modal-content h2 {
            color: var(--white);
            font-size: 2.5rem;
            margin-bottom: 25px;
            font-weight: 900;
        }
        
        #feedback-text {
            font-size: 1.5rem;
            line-height: 1.8;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            margin: 25px 0 35px;
            color: var(--white);
            font-weight: 700;
            border-left: 4px solid var(--accent);
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
        .card-actions {
            display: grid;
            gap: 12px;
        }
        
        .btn-modal {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(255, 107, 107, 0.1));
            color: var(--white);
            padding: 16px;
            border-radius: 14px;
            text-decoration: none;
            font-weight: 800;
            font-size: 1rem;
            border: 2px solid rgba(255, 107, 107, 0.3);
            transition: var(--transition);
            text-align: center;
        }
        
        .btn-modal:hover {
            background: var(--accent);
            transform: translateY(-3px);
            border-color: var(--accent);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
        }
        
        /* --- Ø¹Ù†Ø§ØµØ± Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ù† Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø«Ø§Ù†ÙŠ --- */
        .quiz-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px 25px;
            margin-bottom: 40px;
            box-shadow: var(--shadow-md);
            border: 1.5px solid rgba(255, 107, 107, 0.1);
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
        }
        
        .stat-icon {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--accent);
        }
        
        .stat-number {
            display: block;
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--primary);
            line-height: 1;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 700;
        }
        
        .stat-separator {
            width: 2px;
            height: 40px;
            background: linear-gradient(to bottom, transparent, var(--accent), transparent);
            margin: 0 15px;
        }
        
        /* --- ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¬ÙˆØ§Ù„ --- */
        @media (max-width: 768px) {
            .container {
                margin: 90px auto 30px;
                padding: 0 15px;
            }
            
            .nav-container {
                padding: 12px 15px;
            }
            
            .uni-name {
                font-size: 1rem;
            }
            
            .app-tag {
                font-size: 0.8rem;
            }
            
            .btn-cancel {
                padding: 8px 16px;
                font-size: 0.85rem;
            }
            
            .q-card {
                padding: 25px 20px;
                border-radius: 20px;
            }
            
            .q-text-eng {
                font-size: 1.15rem;
                padding-left: 10px;
            }
            
            .opt-btn {
                padding: 16px 20px;
                font-size: 0.95rem;
            }
            
            .badge {
                font-size: 0.85rem;
                padding: 6px 16px;
            }
            
            #submit-btn, #review-btn, #exit-review-btn {
                padding: 16px 30px;
                font-size: 1.1rem;
                min-width: 200px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .modal-content {
                padding: 40px 25px;
                margin: 0 10px;
            }
            
            .modal-content h2 {
                font-size: 2rem;
            }
            
            #feedback-text {
                font-size: 1.3rem;
                padding: 15px;
            }
            
            .quiz-stats {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .stat-separator {
                width: 80%;
                height: 2px;
                margin: 10px auto;
                background: linear-gradient(to right, transparent, var(--accent), transparent);
            }
        }
        
        @media (max-width: 480px) {
            .q-text-eng {
                font-size: 1.05rem;
            }
            
            .opt-btn {
                padding: 14px 18px;
            }
            
            #submit-btn, #review-btn, #exit-review-btn {
                padding: 14px 25px;
                font-size: 1rem;
                min-width: 180px;
            }
            
            .modal-content h2 {
                font-size: 1.8rem;
            }
            
            #feedback-text {
                font-size: 1.2rem;
            }
        }
        
        /* --- Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† --- */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: rgba(30, 41, 59, 0.95);
                --text-main: #f1f5f9;
                --text-muted: #cbd5e1;
            }
            
            body {
                background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            }
            
            .opt-btn {
                background: #334155;
                border-color: #475569;
                color: #f1f5f9;
            }
            
            .opt-btn:hover, .opt-btn.selected {
                background: #475569;
                border-color: var(--accent);
            }
            
            .progress-bar {
                background: #334155;
            }
            
            .quiz-stats {
                background: rgba(30, 41, 59, 0.8);
                border-color: rgba(255, 107, 107, 0.1);
            }
        }
        
        /* --- ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© --- */
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }
        
        /* --- Ø¥Ø´Ø¹Ø§Ø± --- */
        .notification {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            z-index: 10000;
            font-weight: bold;
            animation: slideInNotification 0.3s ease;
            max-width: 300px;
            text-align: center;
            display: none;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
        }
        
        @keyframes slideInNotification {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="quiz-body">

    <!-- Ø§Ù„Ù†Ø§ÙØ¨Ø§Ø± -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <span class="uni-name" id="quiz-title">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                <span class="app-tag">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°ÙƒÙŠØ© ğŸ§ </span>
            </div>
            <a href="exercises.html" class="btn-cancel">
                <i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¯Ø±ÙŠØ¨
            </a>
        </div>
    </nav>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main class="container">
        <!-- Ø§Ù„Ù„ÙˆØ¯Ø± -->
        <div id="loader">
            <div class="spinner"></div>
            <p>Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø³Ø±Ø¹Ø© Ø§Ù„ØµØ§Ø±ÙˆØ®... ğŸš€</p>
        </div>

        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) -->
        <div class="quiz-stats" id="quiz-stats" style="display: none;">
            <div class="stat-item">
                <div class="stat-icon">ğŸ“Š</div>
                <span class="stat-number" id="stats-total">0</span>
                <span class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span>
            </div>
            
            <div class="stat-separator"></div>
            
            <div class="stat-item">
                <div class="stat-icon">â±ï¸</div>
                <span class="stat-number" id="stats-time">00:00</span>
                <span class="stat-label">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ù‚Ø¶ÙŠ</span>
            </div>
            
            <div class="stat-separator"></div>
            
            <div class="stat-item">
                <div class="stat-icon">âœ…</div>
                <span class="stat-number" id="stats-answered">0</span>
                <span class="stat-label">ØªÙ…Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</span>
            </div>
        </div>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
        <div class="progress-bar" id="progress-container">
            <div id="quiz-progress" class="progress"></div>
        </div>

        <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
        <div id="question-container"></div>

        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
        <div class="quiz-footer">
            <div class="action-buttons">
                <button id="submit-btn" onclick="showResults()">
                    <i class="fas fa-paper-plane"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
                </button>
                <button id="review-btn" onclick="enterReviewMode()">
                    <i class="fas fa-search"></i> Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
                </button>
                <button id="exit-review-btn" onclick="exitReviewMode()" style="display: none;">
                    <i class="fas fa-times"></i> Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                </button>
            </div>
        </div>
    </main>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
    <div id="resultModal" class="modal-overlay" onclick="if(event.target===this) this.style.display='none'">
        <div class="modal-content">
            <h2 id="score-text">Ù†ØªÙŠØ¬ØªÙƒ: 0%</h2>
            <div id="feedback-text"></div>
            <div class="card-actions">
                <a href="exercises.html" class="btn-modal">
                    <i class="fas fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø¨Ù†Ùƒ Ø§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª
                </a>
                <a href="javascript:enterReviewMode()" class="btn-modal" style="background: rgba(255, 107, 107, 0.3);">
                    <i class="fas fa-search"></i> Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª
                </a>
                <a href="javascript:restartQuiz()" class="btn-modal" style="background: rgba(255,255,255,0.1);">
                    <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
                </a>
            </div>
        </div>
    </div>

    <!-- Ø¥Ø´Ø¹Ø§Ø± -->
    <div id="notification" class="notification"></div>

    <script>
        // === Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ===
        let questions = [];
        let userAnswers = {};
        let isReviewMode = false;
        let quizCompleted = false;
        let startTime = null;
        let timerInterval = null;
        let totalTime = 0;
        const urlParams = new URLSearchParams(window.location.search);
        const lecId = urlParams.get('lec');
        
        // === ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ===
        async function loadQuestions() {
            if (!lecId) {
                document.getElementById('quiz-title').innerText = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„';
                document.getElementById('loader').innerHTML = `
                    <div style="color: var(--danger); font-size: 1.2rem; margin-bottom: 20px;">
                        <i class="fas fa-exclamation-triangle fa-2x"></i>
                    </div>
                    <p>Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©</p>
                    <a href="exercises.html" class="btn-modal" style="margin-top: 20px; background: var(--accent); color: white;">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª</a>
                `;
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ¯ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
            const dataFiles = {
                '1': 'lec1_data.js',
                '2': 'lec2_data.js',
                '3': 'lec3_data.js',
                '4': 'lec4_data.js',
                '5': 'lec5_data.js',
                '7': 'lec7_data.js',
                '8': 'lec8_data.js',
                '9': 'lec9_data.js',
                '10': 'lec10_data.js'
            };
            
            const dataFile = dataFiles[lecId];
            if (!dataFile) {
                showError('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                return;
            }
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            try {
                const script = document.createElement('script');
                script.src = dataFile;
                script.async = true;
                
                script.onload = () => {
                    if (typeof quizData !== 'undefined') {
                        questions = quizData.questions;
                        document.getElementById('quiz-title').innerText = quizData.title;
                        document.getElementById('stats-total').textContent = questions.length;
                        showNotification(`ØªÙ… ØªØ­Ù…ÙŠÙ„ ${questions.length} Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!`);
                        renderQuestions();
                    } else {
                        showError('Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                    }
                };
                
                script.onerror = () => {
                    showError('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                };
                
                document.head.appendChild(script);
                
            } catch (error) {
                showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹');
                console.error(error);
            }
        }
        
        // === Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ===
        function renderQuestions() {
            const container = document.getElementById('question-container');
            let fullHtml = '';
            
            questions.forEach((q, idx) => {
                fullHtml += `
                <div class="q-card" data-index="${idx}">
                    <span class="badge">Ø³Ø¤Ø§Ù„ ${idx + 1}</span>
                    <div class="correct-badge">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©</div>
                    <p class="q-text-eng">${q.text}</p>
                    <div class="options-container">
                        ${q.options.map((opt, oIdx) => `
                            <button class="opt-btn" onclick="selectOption(${idx}, ${oIdx}, this)" 
                                    data-q="${idx}" data-option="${oIdx}"
                                    data-correct="${oIdx === q.correct ? 'true' : 'false'}">
                                <span style="font-weight: 800; margin-left: 10px;">${String.fromCharCode(65 + oIdx)})</span>
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                </div>`;
            });
            
            container.innerHTML = fullHtml;
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø­Ø±Ø± Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ
            if (window.renderMathInElement) {
                renderMathInElement(container, {
                    delimiters: [
                        { left: "$$", right: "$$", display: true },
                        { left: "$", right: "$", display: false },
                        { left: "\\(", right: "\\)", display: false },
                        { left: "\\[", right: "\\]", display: true }
                    ],
                    throwOnError: false
                });
            }
            
            completeLoading();
        }
        
        // === Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ===
        function completeLoading() {
            const loader = document.getElementById('loader');
            const container = document.getElementById('question-container');
            const stats = document.getElementById('quiz-stats');
            
            setTimeout(() => {
                loader.style.opacity = '0';
                loader.style.transform = 'translateY(-20px)';
                loader.style.transition = 'all 0.5s ease';
                
                setTimeout(() => {
                    loader.style.display = 'none';
                    stats.style.display = 'flex';
                    container.classList.add('loaded');
                    document.getElementById('submit-btn').style.display = 'block';
                    
                    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ø¹ ØªØ£Ø«ÙŠØ±
                    setTimeout(() => {
                        stats.style.opacity = '0';
                        stats.style.transform = 'translateY(-10px)';
                        stats.style.display = 'flex';
                        
                        setTimeout(() => {
                            stats.style.opacity = '1';
                            stats.style.transform = 'translateY(0)';
                            stats.style.transition = 'all 0.5s ease';
                        }, 100);
                    }, 100);
                    
                    // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
                    startTimer();
                    
                    // Ø¸Ù‡ÙˆØ± Ù…ØªØªØ§Ù„ÙŠ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
                    const cards = document.querySelectorAll('.q-card');
                    cards.forEach((card, index) => {
                        setTimeout(() => {
                            card.style.animationDelay = `${index * 0.1}s`;
                        }, 50);
                    });
                }, 500);
            }, 300);
        }
        
        // === Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª ===
        function startTimer() {
            startTime = new Date();
            timerInterval = setInterval(() => {
                totalTime++;
                document.getElementById('stats-time').textContent = formatTime(totalTime);
            }, 1000);
        }
        
        // === ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª ===
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        // === Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ===
        function selectOption(qIdx, oIdx, btn) {
            // Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
            if (isReviewMode) return;
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø®ÙŠØ§Ø±Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„
            document.querySelectorAll(`[data-q="${qIdx}"]`).forEach(b => {
                b.classList.remove('selected');
                b.style.borderColor = '#f1f5f9';
                b.style.background = '#f8fafc';
            });
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
            btn.classList.add('selected');
            btn.style.borderColor = 'var(--accent)';
            btn.style.background = 'linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05))';
            
            // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
            userAnswers[qIdx] = oIdx;
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            updateProgress();
            updateStats();
            
            // ØªØ£Ø«ÙŠØ± ØµÙˆØªÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
            playClickSound();
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù†Ø¬Ø§Ø­ ØµØºÙŠØ±
            showNotification('ØªÙ… Ø­ÙØ¸ Ø¥Ø¬Ø§Ø¨ØªÙƒ âœ“', 'success');
        }
        
        // === ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… ===
        function updateProgress() {
            const solved = Object.keys(userAnswers).length;
            const progress = (solved / questions.length) * 100;
            const progressBar = document.getElementById('quiz-progress');
            
            progressBar.style.width = `${progress}%`;
            
            // ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø­Ø³Ø¨ Ø§Ù„ØªÙ‚Ø¯Ù…
            if (progress >= 75) {
                progressBar.style.background = 'linear-gradient(90deg, var(--success), #16a34a)';
            } else if (progress >= 50) {
                progressBar.style.background = 'linear-gradient(90deg, var(--warning), #d97706)';
            } else {
                progressBar.style.background = 'linear-gradient(90deg, var(--accent), var(--accent-dark))';
            }
        }
        
        // === ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ===
        function updateStats() {
            const answered = Object.keys(userAnswers).length;
            document.getElementById('stats-answered').textContent = answered;
        }
        
        // === Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© ===
        function calculateScore() {
            let score = 0;
            questions.forEach((q, idx) => {
                if (userAnswers[idx] === q.correct) {
                    score++;
                }
            });
            return Math.round((score / questions.length) * 100);
        }
        
        // === Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ===
        function showResults() {
            const totalQuestions = questions.length;
            const answeredQuestions = Object.keys(userAnswers).length;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
            if (answeredQuestions < totalQuestions) {
                const unanswered = totalQuestions - answeredQuestions;
                const confirmMsg = unanswered === 1 
                    ? 'ÙŠÙˆØ¬Ø¯ Ø³Ø¤Ø§Ù„ ÙˆØ§Ø­Ø¯ Ù„Ù… ØªØ¬Ø¨ Ø¹Ù„ÙŠÙ‡. Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØµØ­ÙŠØ­ØŸ'
                    : `ÙŠÙˆØ¬Ø¯ ${unanswered} Ø£Ø³Ø¦Ù„Ø© Ù„Ù… ØªØ¬Ø¨ Ø¹Ù„ÙŠÙ‡Ø§. Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªØµØ­ÙŠØ­ØŸ`;
                
                if (!confirm(confirmMsg)) {
                    return;
                }
            }
            
            // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª
            clearInterval(timerInterval);
            quizCompleted = true;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©
            const finalScore = calculateScore();
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ù…Ø¹ Ø§Ù„Ù†ØªÙŠØ¬Ø©
            document.getElementById('score-text').innerText = `Ù†ØªÙŠØ¬ØªÙƒ: ${finalScore}%`;
            
            const feedback = document.getElementById('feedback-text');
            if (finalScore === 100) {
                feedback.innerHTML = "Ù‚ÙØ´ØªÙƒ ğŸ«µ Ø§Ù…Ø³Ùƒ Ø¯Ø­ÙŠØ­ Ø´Ø§Ø·Ø±<br>Ù…ÙÙŠØ´ Ø­Ø§Ø¬Ø© Ø¨ØªÙÙˆØªÙƒ ÙˆØ§Ù„Ù„Ù‡!";
            }
            else if (finalScore >= 85) {
                feedback.innerHTML = "ÙÙŠ Ù…Ø«Ù„ ØµÙŠÙ†ÙŠ Ù‚Ø¯ÙŠÙ… Ø¨ÙŠÙ‚ÙˆÙ„ Ø§Ù†Ùƒ Ø¬Ø§Ù…Ø¯ Ø¹Ù„Ù‰ Ø·ÙˆÙ„ ğŸ˜ğŸš€<br>Ù…Ø§Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ Ù…Ø³ØªÙˆØ§Ùƒ Ø±Ù‡ÙŠØ¨!";
            }
            else if (finalScore >= 70) {
                feedback.innerHTML = "Ø´ØºØ§Ù„ ÙŠØ§ ØµØ§Ø­Ø¨ÙŠ.. <br>Ø¨Ø³ Ø´Ø¯ Ø­ÙŠÙ„Ùƒ Ø¹Ø´Ø§Ù† Ø§Ù„Ù…ÙŠØ¯ØªØ±Ù… Ù…ÙŠØ²Ø¹Ù„Ù†Ø§Ø´ ğŸ˜…ğŸ‘Œ";
            }
            else if (finalScore >= 50) {
                feedback.innerHTML = "Ø¥Ù†Øª Ù†Ø¬Ø­Øª Ø²Ù‚! <br>Ø§Ù„Ù„ÙŠ Ù‡Ùˆ ÙŠØ§ Ø¯ÙˆØ¨ Ø¹Ø¯ÙŠØª Ù…Ù† Ù‚Ø¯Ø§Ù… Ø§Ù„Ø¨Ø§Ø¨.. Ø±ÙƒØ² ÙŠØ§ Ø¨Ø·Ù„! ğŸ¢";
            }
            else if (finalScore > 0) {
                feedback.innerHTML = "Ø­Ø±Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙŠ Ø¹Ø¯Ø§Ùƒ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ ÙˆØ§Ù„Ù„Ù‡! <br>Ø¥Ù†Øª ÙƒÙ†Øª Ø¨ØªØ±Ø³Ù… Ø¹ØµØ§ÙÙŠØ± ÙÙŠ ÙˆØ±Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©ØŸ ğŸ’€ğŸ˜‚";
            }
            else {
                feedback.innerHTML = "ØµÙØ±ØŸ! <br>Ø¯Ù‡ Ø¥Ù†Øª Ù…Ø¬ÙŠØªØ´ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø© ÙˆÙ„Ø§ Ø´ÙˆÙØªÙ‡Ø§ Ø­ØªÙ‰.. Ø¥Ù‚ÙÙ„ ÙˆØ§ÙØªØ­ Ø§Ù„ÙƒØªØ§Ø¨ ÙŠØ§ Ø¨Ø§Ø¦Ø³! ğŸ˜­ğŸ¤£";
            }
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ù…Ø¹ ØªØ£Ø«ÙŠØ±
            const modal = document.getElementById('resultModal');
            modal.style.display = 'flex';
            
            // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
            document.getElementById('submit-btn').style.display = 'none';
            document.getElementById('review-btn').style.display = 'block';
            
            // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©
            saveResult(finalScore);
            
            // Ù„Ø¹Ø¨ ØªØ£Ø«ÙŠØ± ØµÙˆØªÙŠ
            playResultSound(finalScore);
        }
        
        // === Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ===
        function saveResult(score) {
            const subject = 'literature'; // Ø£Ùˆ Ø£ÙŠ Ù…Ø§Ø¯Ø© Ø£Ø®Ø±Ù‰
            const progressKey = `${subject}_quiz_progress`;
            
            let progress = JSON.parse(localStorage.getItem(progressKey)) || {};
            
            if (!progress[lecId]) {
                progress[lecId] = {};
            }
            
            progress[lecId].score = score;
            progress[lecId].completed = true;
            progress[lecId].attempts = (progress[lecId].attempts || 0) + 1;
            progress[lecId].completedAt = new Date().toISOString();
            progress[lecId].timeSpent = totalTime;
            
            localStorage.setItem(progressKey, JSON.stringify(progress));
            
            console.log(`ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${score}% Ù„Ù„Ù…Ø­Ø§Ø¶Ø±Ø© ${lecId}`);
            showNotification('ØªÙ… Ø­ÙØ¸ Ù†ØªÙŠØ¬ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­! âœ“', 'success');
        }
        
        // === ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ===
        function enterReviewMode() {
            isReviewMode = true;
            
            // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ø§Ø³ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø³Ù…
            document.body.classList.add('review-mode');
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¸Ø§Ù‡Ø±Ø§Ù‹
            document.getElementById('resultModal').style.display = 'none';
            
            // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
            document.getElementById('review-btn').style.display = 'none';
            document.getElementById('exit-review-btn').style.display = 'block';
            
            // ØªØ·Ø¨ÙŠÙ‚ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
            applyReviewMode();
            
            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            document.querySelector('.progress-bar').style.opacity = '0.5';
            
            // Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯
            showNotification('ğŸ” Ø§Ù„Ø¢Ù† ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©: Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© ÙˆØ§Ù„Ø®Ø§Ø·Ø¦Ø©');
        }
        
        // === ØªØ·Ø¨ÙŠÙ‚ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ===
        function applyReviewMode() {
            questions.forEach((q, idx) => {
                const questionCard = document.querySelector(`.q-card[data-index="${idx}"]`);
                const userAnswer = userAnswers[idx];
                
                // ØªÙ„ÙˆÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
                document.querySelectorAll(`[data-q="${idx}"]`).forEach(btn => {
                    const optionIndex = parseInt(btn.getAttribute('data-option'));
                    const isCorrect = optionIndex === q.correct;
                    const isUserAnswer = optionIndex === userAnswer;
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ ØªØ£Ø«ÙŠØ±Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
                    btn.classList.remove('selected', 'correct-answer', 'wrong-answer', 'not-selected');
                    
                    // ØªÙ„ÙˆÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
                    if (isCorrect) {
                        btn.classList.add('correct-answer');
                    } else if (isUserAnswer && !isCorrect) {
                        btn.classList.add('wrong-answer');
                    } else {
                        btn.classList.add('not-selected');
                    }
                    
                    // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø± ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
                    btn.style.cursor = 'default';
                    btn.onclick = null;
                });
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø±Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                questionCard.querySelector('.correct-badge').style.display = 'block';
            });
        }
        
        // === Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ===
        function exitReviewMode() {
            isReviewMode = false;
            
            // Ø¥Ø²Ø§Ù„Ø© ÙƒÙ„Ø§Ø³ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ù† Ø§Ù„Ø¬Ø³Ù…
            document.body.classList.remove('review-mode');
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.getElementById('exit-review-btn').style.display = 'none';
            document.getElementById('review-btn').style.display = 'block';
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            resetReviewMode();
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            document.querySelector('.progress-bar').style.opacity = '1';
            
            // Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯
            showNotification('âœ… ØªÙ… Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', 'success');
        }
        
        // === Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ===
        function resetReviewMode() {
            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
            document.querySelectorAll('.correct-badge').forEach(badge => {
                badge.style.display = 'none';
            });
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            document.querySelectorAll('.opt-btn').forEach(btn => {
                btn.classList.remove('correct-answer', 'wrong-answer', 'not-selected');
                btn.style.cursor = 'pointer';
                btn.style.borderColor = '#f1f5f9';
                btn.style.background = '#f8fafc';
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø±
                const qIdx = btn.getAttribute('data-q');
                const oIdx = btn.getAttribute('data-option');
                btn.onclick = () => selectOption(qIdx, oIdx, btn);
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
                if (userAnswers[qIdx] === parseInt(oIdx)) {
                    btn.classList.add('selected');
                    btn.style.borderColor = 'var(--accent)';
                    btn.style.background = 'linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05))';
                }
            });
        }
        
        // === Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ===
        function restartQuiz() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©ØŸ Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©.')) {
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
                userAnswers = {};
                quizCompleted = false;
                isReviewMode = false;
                totalTime = 0;
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª
                clearInterval(timerInterval);
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                document.body.classList.remove('review-mode');
                document.getElementById('resultModal').style.display = 'none';
                document.getElementById('submit-btn').style.display = 'block';
                document.getElementById('review-btn').style.display = 'none';
                document.getElementById('exit-review-btn').style.display = 'none';
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
                resetReviewMode();
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
                document.querySelector('.progress-bar').style.opacity = '1';
                document.getElementById('quiz-progress').style.width = '0%';
                document.getElementById('quiz-progress').style.background = 'linear-gradient(90deg, var(--accent), var(--accent-dark))';
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                updateStats();
                document.getElementById('stats-time').textContent = '00:00';
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª
                startTimer();
                
                // Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯
                showNotification('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }
        
        // === ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© ===
        function playClickSound() {
            // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØµÙˆØª Ù†Ù‚Ø± Ù‡Ù†Ø§
            try {
                const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQ=');
                audio.volume = 0.3;
                audio.play().catch(() => {});
            } catch (e) {}
        }
        
        function playResultSound(score) {
            // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø£ØµÙˆØ§Øª Ù…Ø®ØªÙ„ÙØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©
            try {
                if (score >= 70) {
                    // ØµÙˆØª Ù†Ø¬Ø§Ø­
                } else {
                    // ØµÙˆØª ØªØ­ÙÙŠØ²
                }
            } catch (e) {}
        }
        
        function showError(message) {
            const loader = document.getElementById('loader');
            loader.innerHTML = `
                <div style="color: var(--danger); font-size: 1.5rem; margin-bottom: 20px;">
                    <i class="fas fa-exclamation-circle fa-2x"></i>
                </div>
                <p style="color: var(--danger); font-weight: 700; margin-bottom: 20px;">${message}</p>
                <a href="exercises.html" class="btn-modal" style="background: var(--accent); color: white; padding: 12px 24px; border-radius: 12px; text-decoration: none; display: inline-block;">
                    <i class="fas fa-arrow-right"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª
                </a>
            `;
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            
            // ØªÙ„ÙˆÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
            if (type === 'success') {
                notification.style.background = 'linear-gradient(135deg, var(--success), #16a34a)';
            } else if (type === 'warning') {
                notification.style.background = 'linear-gradient(135deg, var(--warning), #d97706)';
            } else if (type === 'danger') {
                notification.style.background = 'linear-gradient(135deg, var(--danger), #dc2626)';
            } else {
                notification.style.background = 'linear-gradient(135deg, var(--accent), var(--accent-dark))';
            }
            
            notification.style.display = 'block';
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†
            setTimeout(() => {
                notification.style.animation = 'slideOutNotification 0.3s ease';
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.style.animation = '';
                }, 300);
            }, 3000);
        }
        
        // === Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù‡ØªØ²Ø§Ø² Ù„Ù„CSS ===
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
            
            @keyframes slideOutNotification {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
        
        // === Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø© ===
        window.addEventListener('DOMContentLoaded', loadQuestions);
        
        // === Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ESC ===
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('resultModal').style.display = 'none';
            }
        });
        
        // === ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø±ÙˆØ¬ ===
        window.addEventListener('beforeunload', function() {
            if (window.opener && !quizCompleted) {
                try {
                    if (typeof window.opener.updateSubjectProgress === 'function') {
                        window.opener.updateSubjectProgress('literature');
                    }
                } catch (e) {}
            }
        });
    </script>
</body>
</html>
